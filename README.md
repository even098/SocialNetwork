# Social Network API

## Описание
API социальной сети, где пользователи могут выкладывать посты с фото, комментировать их, ставить лайки и подписываться друг на друга.

## Технологии
- **Python** + **Django Rest Framework**  
- **Djoser + SimpleJWT** (аутентификация и регистрация)
- **Google OAuth2** (вход через Google)
- **TaggableManager** (работа с тегами)
- **Websockets** (реализация чатов)
- **PostgreSQL** (БД)

## Функционал
### 1. Аутентификация и регистрация
- Регистрация через Djoser или Google OAuth2
- Авторизация через JWT-токены

### 2. Посты
- Создание постов (заголовок + фото + теги)
- Редактирование и удаление своих постов
- Просмотр постов

### 3. Комментарии
- Добавление комментариев к постам
- Лайки для комментариев
- CRUD для комментариев

### 4. Лайки
- Лайки для постов и комментариев

### 5. Подписки
- Подписка и отписка от пользователей

### 6. Чаты
- Создание/удаление чат
- Отправка сообщений в чат
- Мгновенное получение сообщений реализовано через WebSocket

### 7. Уведомления
- Уведомления о лайках и комментариях (Сделано через сигналы post_save/post_delete)

### 8. Поиск
- Поиск чата по имени чата и/или username/full_name пользователя, который в нем состоит
- Поиск сообщений по ключевому слову. Поиск осуществляется через full-text search
- Поиск постов по username/full_name автора и/или ключевому слову. Реализовано так же через full-text search
- Поиск пользователей по username или full_name

### 9. Feed (Неокончено)
- "Рекомендация" постов на основе поставленных лайков

## Установка и запуск
```bash
# Клонирование репозитория
git clone https://github.com/even098/SocialNetwork.git
cd SocialNetwork

# Установка зависимостей
pip install -r requirements.txt

# Применение миграций
python manage.py migrate

# Запуск сервера
python manage.py runserver
```

## Доступные эндпойнты

### Аутентификация (Djoser) (базовый url - `/api/v1/users`)
| Метод  | Эндпойнт                              | Данные                                                     | Описание                                    |
|--------|---------------------------------------|------------------------------------------------------------|---------------------------------------------|
| POST   | `/auth/users/`                        | `{username, email, password, full_name, gender, location}` | Регистрация нового пользователя             |
| POST   | `/auth/users/activation/`             | `{uid, token}`                                             | Активация аккаунта (если включена)          |
| POST   | `/auth/users/resend_activation/`      | `{email}`                                                  | Повторная отправка активационного письма    |
| POST   | `/auth/users/reset_password/`         | `{email}`                                                  | Запрос на сброс пароля                      |
| POST   | `/auth/users/reset_password_confirm/` | `{uid, token, new_password}`                               | Подтверждение сброса пароля                 |
| POST   | `/auth/users/set_password/`           | `{current_password, new_password}`                         | Смена пароля                                |
| POST   | `/auth/users/set_username/`           | `{current_password, new_username}`                         | Смена имени пользователя                    |
| GET    | `/auth/users/me/`                     | -                                                          | Получение информации о текущем пользователе |
| PATCH  | `/auth/users/me/`                     | `{username, email}`                                        | Обновление информации о пользователе        |
| GET    | `/auth/users/`                        | -                                                          | Список пользователей                        |
| GET    | `/auth/users/{id}/`                   | -                                                          | Детальная информация о пользователе         |
| POST   | `/auth/jwt/create/`                   | `{email, password}`                                        | Получение JWT-токена                        |
| POST   | `/auth/jwt/refresh/`                  | `{refresh}`                                                | Обновление access-токена                    |
| POST   | `/auth/jwt/verify/`                   | `{token}`                                                  | Проверка валидности токена                  |

### Аутентификация (Google OAuth2) (базовый url - `/api/v1/users`)
| Метод | Эндпойнт                | Данные | Описание                                         |
|-------|-------------------------|--------|--------------------------------------------------|
| GET   | `/google-oauth2/login/` | -      | Перенаправление на страницу выбора гугл-аккаунта |

### Пользователи (базовый url - `/api/v1/users`)
| Метод     | Эндпойнт         | Данные                     | Описание                      |
|-----------|------------------|----------------------------|-------------------------------|
| GET       | `/profile/{id}/` | -                          | Просмотр профиля пользователя |
| PUT/PATCH | `/profile/edit/` | Доступные поля модели User | Редактирование профиля        |

### Посты (базовый url - `/api/v1/posts`)
| Метод     | Эндпойнт          | Данные                   | Описание                            |
|-----------|-------------------|--------------------------|-------------------------------------|
| GET       | `/{id}/comments/` | -                        | Получение списка комментариев поста |
| POST      | `/create/`        | `{content, photo, tags}` | Создание нового поста               |
| PUT/PATCH | `/edit/{id}/`     | `{content, photo, tags}` | Редактирование поста                |
| DELETE    | `/delete/{id}/`   | -                        | Удаление поста                      |

### Комментарии (базовый url - `api/v1/comments`)
| Метод     | Эндпойнт        | Данные               | Описание                   |
|-----------|-----------------|----------------------|----------------------------|
| POST      | `/create/`      | `{text}, {post_id}`  | Добавление комментария     |
| PUT/PATCH | `/edit/{id}/`   | `{text}`             | Редактирование комментария |
| DELETE    | `/delete/{id}/` | -                    | Удаление комментария       |

### Лайки (базовый url - `api/v1`)
| Метод  | Эндпойнт                 | Данные | Описание                 |
|--------|--------------------------|--------|--------------------------|
| POST   | `/posts/like/{id}/`      | -      | Лайк/дизлайк поста       |
| POST   | `/comments/like/{id}/`   | -      | Лайк/дизлайк комментария |

### Подписки (базовый url - `api/v1/relationships`)
| Метод  | Эндпойнт           | Данные | Описание                        |
|--------|--------------------|--------|---------------------------------|
| POST   | `/follow/{id}`     | -      | Подписка на пользователя        |
| DELETE | `/unfollow/{id}/`  | -      | Отписка от пользователя         |
| GET    | `/followers/{id}/` | -      | Список подписчиков пользователя |
| DELETE | `/following/{id}/` | -      | Список подписок пользователя    |

### Уведомления (базовый url - `api/v1/notifications`)
| Метод  | Эндпойнт      | Данные | Описание                                 |
|--------|---------------|--------|------------------------------------------|
| GET    | `/`           | -      | Получение списка уведомлений             |
| POST   | `/read/{id}/` | -      | Пометка уведомления как прочитанное      |
| POST   | `/read/all/`  | -      | Пометка всех уведомлений как прочитанные |

### Чаты (базовый url - `api/v1/chats`)
| Метод  | Эндпойнт              | Данные             | Описание                                         |
|--------|-----------------------|--------------------|--------------------------------------------------|
| GET    | `/`                   | -                  | Получение списка чатов                           |
| POST   | `/`                   | `{participant_id}` | Создание чата с пользователем                    |
| GET    | `/{id}/`              | -                  | Получение информации о чате                      |
| DELETE | `/{id}/`              | -                  | Удаление чата                                    |
| GET    | `/{id}/messages/`     | -                  | Получение всех сообщений чата                    |
| POST   | `/{id}/messages/`     | `{text}`           | Отправка сообщения в чат                         |
| GET    | `/unread/`            | -                  | Получение количества непрочитанных сообщений     |
| PATCH  | `/{id}/mark_as_read/` | `{message_ids}`    | Пометка сообщений чата как прочитанное           |
| GET    | `/connect/`           | -                  | Получение `WebSocket-URL` для подключения к чату |

### Поиск (базовый url - `api/v1/search`)
| Метод | Эндпойнт                                 | Данные | Описание                                     |
|-------|------------------------------------------|--------|----------------------------------------------|
| GET   | `/chats?name={chat_name}&users={user}`   | -      | Поиск чатов по имени или участнику           |
| GET   | `/messages?keyword={keyword}`            | -      | Поиск сообщений по ключевому слову           |
| GET   | `/posts?author={user}&keyword={keyword}` | -      | Поиск постов по автору или ключевому слову   |
| GET   | `/users?keyword={user}`                  | -      | Поиск профилей по `username` или `full_name` |

### Feed (базовый url - `api/v1/feed`)
| Метод | Эндпойнт            | Данные | Описание              |
|-------|---------------------|--------|-----------------------|
| GET   | `/recommendations/` | -      | Рекомендованные посты |
